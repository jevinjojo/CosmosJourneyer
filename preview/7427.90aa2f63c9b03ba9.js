/*
 *  This file is part of Cosmos Journeyer
 *
 *  Copyright (C) 2024 Barthélemy Paléologue <barth.paleologue@cosmosjourneyer.com>
 *
 *  This program is free software: you can redistribute it and/or modify
 *  it under the terms of the GNU Affero General Public License as published by
 *  the Free Software Foundation, either version 3 of the License, or
 *  (at your option) any later version.
 *
 *  This program is distributed in the hope that it will be useful,
 *  but WITHOUT ANY WARRANTY; without even the implied warranty of
 *  MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *  GNU Affero General Public License for more details.
 *
 *  You should have received a copy of the GNU Affero General Public License
 *  along with this program.  If not, see <https://www.gnu.org/licenses/>.
 */

"use strict";(globalThis.webpackChunkcosmos_journeyer=globalThis.webpackChunkcosmos_journeyer||[]).push([["7427"],{14221:function(e,t,n){e.exports=n.p+"2470ffe0b50b2171.webp"},14280:function(e,t,n){n.d(t,{Iu:()=>o,QB:()=>v,Sf:()=>c,Sl:()=>m,U1:()=>u,XT:()=>s,cs:()=>h,fx:()=>b,gM:()=>f,jw:()=>l,nA:()=>d,tW:()=>y});var r=n(84081),a=n(61834),i=n(42933);function o(e,t){e.setAbsolutePosition(e.getAbsolutePosition().add(t)),e.computeWorldMatrix(!0)}function s(e,t,n,r){e.rotateAround(t,n,r),e.computeWorldMatrix(!0)}function u(e,t,n){e.rotate(t,n,r.T.WORLD)}function l(e){if(null===e.rotationQuaternion)throw Error("Null quaternion for ".concat(e.name));return e.rotationQuaternion}function c(e,t){e.rotationQuaternion=t,e.computeWorldMatrix(!0)}function d(e,t){if(!t.equalsWithEpsilon(e.up,1e-7)){var n=e.up;u(e,a.P.Cross(t,n),-Math.acos(a.P.Dot(t,n)))}}function h(e){return e.getDirection(i.F.FORWARD)}function f(e){return e.getDirection(i.F.UP)}function v(e){return p(e).negate()}function p(e){return e.getDirection(i.F.LEFT)}function m(e,t){u(e,h(e),t)}function y(e,t){u(e,p(e),t)}function b(e,t){u(e,f(e),t)}},15788:function(e,t,n){e.exports=n.p+"ceb0939a515e507b.webp"},24660:function(e,t,n){n.d(t,{_T:()=>c,gr:()=>s,pl:()=>u,xM:()=>l});var r=n(16891),a=n(61834),i=n(14280);function o(e,t){var n=-1,r=t[0];if(void 0===r)throw Error("no bodieees !");var a=!0,i=!1,o=void 0;try{for(var s,u=t[Symbol.iterator]();!(a=(s=u.next()).done);a=!0){var l=s.value,c=e.subtract(l.getTransform().getAbsolutePosition()).length();(-1===n||c<n)&&(r=l,n=c)}}catch(e){i=!0,o=e}finally{try{a||null==u.return||u.return()}finally{if(i)throw o}}return r}function s(e,t,n,r){var o=e.getBoundingRadius(),s=t.length(),u=Math.max(2*o,s),l=e.getTransform().getWorldMatrix(),c=a.P.TransformCoordinates(t.scale(u/(s+1e-4)),l);r.setAbsolutePosition(c);var d=e.getTransform().absoluteRotationQuaternion,h=n.multiply(d);(0,i.Sf)(r,h)}function u(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3,i=o(t.getTransform().getAbsolutePosition(),n.getStellarObjects());if(i===t)e.getTransform().setAbsolutePosition(t.getTransform().getAbsolutePosition().add(new a.P(0,.2,1).scaleInPlace(t.getBoundingRadius()*r)));else{var s=t.getTransform().getAbsolutePosition().subtract(i.getTransform().getAbsolutePosition()),u=s.length();s.scaleInPlace(1/u);var l=i.getTransform().getAbsolutePosition().add(s.scale(u-r*t.getBoundingRadius()));e.getTransform().setAbsolutePosition(l)}n.translateEverythingNow(e.getTransform().getAbsolutePosition().negate()),e.getTransform().setAbsolutePosition(a.P.Zero()),e.getTransform().lookAt(t.getTransform().getAbsolutePosition())}function l(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:3,s=o(t.getTransform().getAbsolutePosition(),n.getStellarObjects());if(s===t)e.getTransform().setAbsolutePosition(t.getTransform().getAbsolutePosition().add(new a.P(0,.2,1).scaleInPlace(t.getBoundingRadius()*r)));else{var u=t.getTransform().getAbsolutePosition().subtract(s.getTransform().getAbsolutePosition()),l=u.length();u.scaleInPlace(1/l);var c=(0,i.gM)(t.getTransform()),d=a.P.Cross(u,c),h=s.getTransform().getAbsolutePosition().add(u.scale(l+1.5*t.getBoundingRadius())).add(d.scale(4*t.getBoundingRadius()));e.getTransform().setAbsolutePosition(h),(0,i.XT)(e.getTransform(),t.getTransform().getAbsolutePosition(),u,-Math.PI/16)}n.translateEverythingNow(e.getTransform().getAbsolutePosition().negate()),e.getTransform().setAbsolutePosition(a.P.Zero());var f=s.getTransform().getAbsolutePosition().subtract(t.getTransform().getAbsolutePosition()).normalize(),v=t.getTransform().getAbsolutePosition().add(f.scale(4*t.getBoundingRadius()));e.getTransform().lookAt(v),e.getTransform().computeWorldMatrix(!0),(0,i.Sl)(e.getTransform(),-Math.PI/8),e.getActiveCamera().getViewMatrix(!0),e.getActiveCamera().getProjectionMatrix(!0)}function c(e,t,n){var s=e.asteroidField;if(null===s)throw Error("The body does not have an asteroid field");var u=e.getTransform().getAbsolutePosition(),l=(0,r.Lerp)(s.innerRadius,s.outerRadius,n),c=o(u,t.getStellarObjects()),d=u.subtract(c.getTransform().getAbsolutePosition()).normalize(),h=(0,i.gM)(e.getTransform()),f=a.P.Cross(d,h).normalize();return u.add(f.scale(l)).add(h.scale(s.patchThickness))}},30369:function(e,t,n){e.exports=n.p+"a818b763cab42c30.webp"},31796:function(e,t,n){n.d(t,{CW:()=>o,Ec:()=>l,Qc:()=>d,a2:()=>u,oZ:()=>c,p5:()=>s,r_:()=>i,th:()=>function e(t,n){return 0===n?t:e(n,t%n)},uZ:()=>a});var r=n(61834);function a(e,t,n){return Math.min(Math.max(e,t),n)}function i(e,t,n){return e>t?Math.max(t,e-n):Math.min(t,e+n)}function o(e,t,n){var r=Math.min(1,Math.max(0,(n-e)/(t-e)));return r*r*(3-2*r)}function s(e){return 2*Math.abs(e-Math.floor(e+.5))}function u(e,t,n,r,a){return r+(e-t)*(a-r)/(n-t)}function l(e,t,n,r){return t+(e-t)*Math.pow(2,-r/n)}function c(e,t,n,a,i){return r._f.SlerpToRef(e,t,Math.pow(2,-a/n),i)}function d(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,r=t,a=0;a<n;a++){var i=e(r);if(1e-8>Math.abs(i))break;var o=(e(r+1e-4)-i)/1e-4;r-=i/o}return r}},32133:function(e,t,n){n.d(t,{M:()=>o,b:()=>i});var r,a=n(32075),i=((r={}).INVALID_JSON="INVALID_JSON",r.INVALID_SAVE="INVALID_SAVE",r.INVALID_STORAGE_FORMAT="INVALID_STORAGE_FORMAT",r);function o(e){switch(e.type){case"INVALID_JSON":return a.Z.t("notifications:invalidSaveFileJson");case"INVALID_SAVE":return a.Z.t("notifications:invalidSaveFile");case"INVALID_STORAGE_FORMAT":return a.Z.t("notifications:invalidStorageFormat")}}},42615:function(e,t,n){e.exports=n.p+"e11ee3cdd6bf505e.webp"},43808:function(e,t,n){e.exports=n.p+"fd7997898bbeb1f1.wasm"},4761:function(e,t,n){n.d(t,{Ae:()=>u,bM:()=>o,eU:()=>s});function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a,i,o=((a={})[a.CHARLOTTE=0]="CHARLOTTE",a),s=((i={})[i.INITIATING_PLANETARY_LANDING=0]="INITIATING_PLANETARY_LANDING",i[i.LANDING_REQUEST_GRANTED=1]="LANDING_REQUEST_GRANTED",i[i.LANDING_COMPLETE=2]="LANDING_COMPLETE",i[i.MISSION_COMPLETE=3]="MISSION_COMPLETE",i[i.NEW_DISCOVERY=4]="NEW_DISCOVERY",i[i.CANNOT_ENGAGE_WARP_DRIVE=5]="CANNOT_ENGAGE_WARP_DRIVE",i[i.WARP_DRIVE_EMERGENCY_SHUT_DOWN=6]="WARP_DRIVE_EMERGENCY_SHUT_DOWN",i[i.WARP_DRIVE_DISENGAGED=7]="WARP_DRIVE_DISENGAGED",i[i.ENGAGING_WARP_DRIVE=8]="ENGAGING_WARP_DRIVE",i[i.FUEL_SCOOPING=9]="FUEL_SCOOPING",i[i.FUEL_SCOOPING_COMPLETE=10]="FUEL_SCOOPING_COMPLETE",i),u=function(){var e;function t(e){if(!(this instanceof t))throw TypeError("Cannot call a class as a function");r(this,"voiceLines",void 0),r(this,"isPlaying",!1),r(this,"soundQueue",[]),this.voiceLines=e}return e=[{key:"getLineFromVoiceLines",value:function(e,t){switch(t){case 0:return e.initiatingPlanetaryLanding;case 1:return e.landingRequestGranted;case 2:return e.landingComplete;case 3:return e.missionComplete;case 4:return e.newDiscovery;case 5:return e.cannotEngageWarpDrive;case 6:return e.warpDriveEmergencyShutDown;case 7:return e.warpDriveDisengaged;case 8:return e.engagingWarpDrive;case 9:return e.fuelScooping;case 10:return e.fuelScoopingComplete}}},{key:"getVoiceLinesFromSpeaker",value:function(e){if(0===e)return this.voiceLines.charlotte}},{key:"sayNow",value:function(e,t){this.getLineFromVoiceLines(this.getVoiceLinesFromSpeaker(e),t).play()}},{key:"enqueueSay",value:function(e,t){this.soundQueue.push(this.getLineFromVoiceLines(this.getVoiceLinesFromSpeaker(e),t))}},{key:"update",value:function(){var e=this;if(!this.isPlaying){var t=this.soundQueue.shift();void 0!==t&&(this.isPlaying=!0,t.play(),t.onEndedObservable.addOnce(function(){e.isPlaying=!1}))}}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),t}()},70104:function(e,t,n){n.d(t,{vG:()=>h});var r=n(85737),a=n(16585),i=n(76473),o=(0,a.c)(i.Z.POWER_PLAY_SEED),s=0,u=(0,r.makeNoise3D)(function(){return o(s++)}),l=(0,a.c)(i.Z.POWER_PLAY_SEED+598),c=0,d=(0,r.makeNoise3D)(function(){return l(c++)});function h(e){var t,n;return{materialistSpiritualist:(t=e.x,.5*u(.2*t,.2*e.y,.2*e.z)+.5),capitalistCommunist:(n=e.x,.5*d(.2*n,.2*e.y,.2*e.z)+.5)}}},7212:function(e,t,n){n.d(t,{d:()=>tk}),n(80781),n(10425),n(99876);var r,a=n(20534),i=n(1167),o=n(71777),s=n(61834),u=n(70541),l=n(95603),c=n(24919),d=n(72392),h=n(87158),f=n(46060),v=n(80247),p=n(32133),m=n(9852),y=n(46526);function b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function g(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var S=function(){var e;function t(){if(!(this instanceof t))throw TypeError("Cannot call a class as a function")}return e=[{key:"write",value:function(e){return localStorage.setItem(t.SAVES_KEY,JSON.stringify(e)),!0}},{key:"read",value:function(e){var n=localStorage.getItem(t.SAVES_KEY),r=localStorage.getItem(t.BACKUP_SAVE_KEY);if(null===n&&null===r)return Promise.resolve((0,y.ok)({}));var a=(0,m.o)(null!=n?n:"{}");if(null===a)return Promise.resolve((0,y.c)({type:p.b.INVALID_JSON}));var i=(0,m.o)(null!=r?r:"{}");if(null===i)return Promise.resolve((0,y.c)({type:p.b.INVALID_JSON}));var o=v.oC.safeParse(a);if(!o.success)return console.error(o.error),Promise.resolve((0,y.c)({type:p.b.INVALID_STORAGE_FORMAT,content:o.error}));var s=v.oC.safeParse(i);if(!s.success)return console.error(s.error),Promise.resolve((0,y.c)({type:p.b.INVALID_STORAGE_FORMAT,content:s.error}));var u=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"==typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){g(e,t,n[t])})}return e}({},o.data,s.data),l={},c={},d=!0,h=!1,f=void 0;try{for(var S,w=Object.entries(u)[Symbol.iterator]();!(d=(S=w.next()).done);d=!0){var E,P=(E=S.value,function(e){if(Array.isArray(e))return e}(E)||function(e,t){var n,r,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var i=[],o=!0,s=!1;try{for(a=a.call(e);!(o=(n=a.next()).done)&&(i.push(n.value),i.length!==t);o=!0);}catch(e){s=!0,r=e}finally{try{o||null==a.return||a.return()}finally{if(s)throw r}}return i}}(E,2)||function(e,t){if(e){if("string"==typeof e)return b(e,2);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return b(e,t)}}(E,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),C=P[0],T=P[1],A=(0,v.Vj)(T.manual,e),L=(0,v.Vj)(T.auto,e);l[C]={manual:A.validSaves,auto:L.validSaves},(A.invalidSaves.length>0||L.invalidSaves.length>0)&&(c[C]={manual:A.invalidSaves.map(function(e){return console.error("Corrupted manual save:",e.save,e.error),e.save}),auto:L.invalidSaves.map(function(e){return console.error("Corrupted auto save:",e.save,e.error),e.save})})}}catch(e){h=!0,f=e}finally{try{d||null==w.return||w.return()}finally{if(h)throw f}}return localStorage.setItem(t.BACKUP_SAVE_KEY,JSON.stringify(c)),Object.keys(c).length>0&&console.warn("Some save files could not be validated! Check the console for more information."),Promise.resolve((0,y.ok)(l))}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),t}();function w(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function E(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}function P(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function C(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function T(e,t){if(e){if("string"==typeof e)return w(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return w(e,t)}}g(S,"SAVES_KEY","saves"),g(S,"BACKUP_SAVE_KEY","backupSaves");var A=function(){var e,t;function n(e,t){if(!(this instanceof n))throw TypeError("Cannot call a class as a function");C(this,"backend",void 0),C(this,"saves",void 0),this.backend=e,this.saves=t}return e=[{key:"getSavesForCmdr",value:function(e){return this.saves.get(e)}},{key:"save",value:function(){var e=Object.fromEntries(this.saves);return this.backend.write(e)}},{key:"renameCmdr",value:function(e,t){var n=this.saves.get(e);void 0!==n&&(n.manual.forEach(function(e){return e.player.name=t}),n.auto.forEach(function(e){return e.player.name=t}))}},{key:"deleteSaveForCmdr",value:function(e,t){var n=this.saves.get(e);if(void 0!==n){var r=n.manual.findIndex(function(e){return e===t});if(-1!==r)return void n.manual.splice(r,1);var a=n.auto.findIndex(function(e){return e===t});-1!==a&&n.auto.splice(a,1)}}},{key:"deleteCmdr",value:function(e){this.saves.delete(e)}},{key:"getCmdrUuids",value:function(){var e;return function(e){if(Array.isArray(e))return w(e)}(e=this.saves.keys())||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||T(e)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},{key:"setCmdrSaves",value:function(e,t){this.saves.set(e,t)}}],t=[{key:"CreateAsync",value:function(e,t){var r;return(r=function(){var r,a,i,o,s,u,l,c,d,h;return function(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){var l=[s,u];if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,r=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){i=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){i.label=l[1];break}if(6===l[0]&&i.label<a[1]){i.label=a[1],a=l;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(l);break}a[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}(this,function(f){switch(f.label){case 0:return[4,e.read(t)];case 1:if(!(r=f.sent()).success)return[2,r];a=new Map,i=!0,o=!1,s=void 0;try{for(u=Object.entries(r.value)[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){var v;v=l.value,d=(c=function(e){if(Array.isArray(e))return e}(v)||function(e,t){var n,r,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var i=[],o=!0,s=!1;try{for(a=a.call(e);!(o=(n=a.next()).done)&&(i.push(n.value),i.length!==t);o=!0);}catch(e){s=!0,r=e}finally{try{o||null==a.return||a.return()}finally{if(s)throw r}}return i}}(v,2)||T(v,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0],h=c[1],(0!==h.manual.length||0!==h.auto.length)&&a.set(d,h)}}catch(e){o=!0,s=e}finally{try{i||null==u.return||u.return()}finally{if(o)throw s}}return[2,(0,y.ok)(new n(e,a))]}})},function(){var e=this,t=arguments;return new Promise(function(n,a){var i=r.apply(e,t);function o(e){E(i,n,a,o,s,"next",e)}function s(e){E(i,n,a,o,s,"throw",e)}o(void 0)})})()}}],e&&P(n.prototype,e),t&&P(n,t),n}(),L=n(96948),O=n(31872),I=n(50137),k=n(92099),M=n(73303);n(78683),n(95698);var V=n(95212);let R=n.p+"17af999e7b7ad57f.mp3",D=n.p+"041ff9a253ed825d.mp3",x=n.p+"1549759e283bd206.ogg",N=n.p+"31e17b20ef567c2c.ogg",_=n.p+"39989db1f505d453.ogg",B=n.p+"d0fafb23c7d554d6.mp3",j=n.p+"e681fd4fea79fa37.ogg",U=n.p+"2a8bc67628c05fba.ogg",F=n.p+"1814b3aace9cf589.ogg",G=n.p+"bf4b326c5ffca2bb.mp3",W=n.p+"368a319571c58001.ogg",Z=n.p+"c1c5397b26a6c809.ogg",z=n.p+"920dd9f7b92185e2.ogg";function Y(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}let K=n.p+"a77f60b1dade8fb8.mp3",H=n.p+"2344fdde5c5a6410.mp3",X=n.p+"a5a4982c205e1a77.mp3",J=n.p+"452710f264d2ba19.mp3",q=n.p+"305475735c5d3c0e.mp3",Q=n.p+"65ceacf6bbb524ce.mp3",$=n.p+"5f6f5bf7bfca113e.mp3",ee=n.p+"4884a61f606c46b6.mp3",et=n.p+"414af932bdf1a85c.mp3",en=n.p+"9bbc526876e8d7f3.mp3",er=n.p+"4c543ebfed7579a0.mp3",ea=n.p+"dea0682c68132870.mp3";function ei(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}let eo=n.p+"d03a87f2075d6f53.mp3",es=n.p+"02b9b418f00b21c6.mp3",eu=n.p+"cd82c2ed886f9749.mp3",el=n.p+"5d862e8381583459.mp3",ec=n.p+"c83251e2246e7d88.mp3",ed=n.p+"64c7906a8f900679.mp3",eh=n.p+"2da6813008740281.mp3",ef=n.p+"b3ce59bafdbe5a25.mp3",ev=n.p+"cb1faa14ee3af51b.mp3",ep=n.p+"398d2c8156e90ba6.mp3",em=n.p+"03f6eca0cfdf0539.mp3";function ey(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}function eb(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}var eg=n(1858);function eS(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}var ew=n(72067),eE=n(74913);function eP(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var eC=function(){var e;function t(e,n){var r=this;if(!(this instanceof t))throw TypeError("Cannot call a class as a function");eP(this,"currentMusic",null),eP(this,"silenceSeconds",0),eP(this,"volume",1),eP(this,"fadeSeconds",3),eP(this,"pauseMusicWhenPaused",!1),eP(this,"starSystemView",void 0),eP(this,"musics",void 0),this.musics=e,this.starSystemView=n;var a=eE.a.audioEngine;if(null===a)throw Error("Audio context is null");a.onAudioUnlockedObservable.add(function(){if(null!==r.currentMusic){var e=r.currentMusic;r.currentMusic=null,r.setMusic(e)}})}return e=[{key:"setMusicFromSelection",value:function(e){if(!(null!==this.currentMusic&&e.includes(this.currentMusic))){var t=e[Math.floor(Math.random()*e.length)];void 0!==t&&this.setMusic(t)}}},{key:"setMusic",value:function(e){if(this.currentMusic!==e){if(null!==this.currentMusic){this.currentMusic.setVolume(0,this.fadeSeconds),this.currentMusic.stop(this.fadeSeconds),this.currentMusic=null,this.silenceSeconds=this.fadeSeconds;return}null!==e&&(this.currentMusic=e,this.currentMusic.stop(),this.currentMusic.setVolume(0),this.currentMusic.play(),this.currentMusic.setVolume(this.volume,this.fadeSeconds),console.log("currently playing",this.currentMusic.name))}}},{key:"setSoundtrackVolume",value:function(e){this.volume=e,null!==this.currentMusic&&this.currentMusic.setVolume(e)}},{key:"update",value:function(e,t,n,r){if(null!==this.currentMusic){if(e&&this.pauseMusicWhenPaused&&this.currentMusic.isPlaying)return void this.currentMusic.pause();if(!e&&this.currentMusic.isPaused)return void this.currentMusic.play();e||this.currentMusic.isPlaying||(this.currentMusic=null,this.silenceSeconds=30+(Math.random()-.5)*20)}if(this.silenceSeconds>0){this.silenceSeconds-=r;return}if(!this.starSystemView.isLoadingSystem()){var a=this.starSystemView.getSpaceshipControls().getSpaceship(),i=this.starSystemView.scene.getActiveControls()===this.starSystemView.getCharacterControls(),o=this.starSystemView.scene.getActiveControls().getTransform().getAbsolutePosition(),u=this.starSystemView.getStarSystem().getNearestOrbitalObject(o),l=s.P.Distance(o,u.getTransform().getAbsolutePosition());if(!t||n)return void this.setMusic(this.musics.wandering);if(!a.isLanded()&&null!==a.getTargetLandingPad())return void this.setMusic(this.musics.straussBlueDanube);var c=a.getInternals().getWarpDrive();switch(u.model.type){case O.o.BLACK_HOLE:this.setMusicFromSelection([this.musics.soaring]);return;case O.o.MANDELBULB:case O.o.JULIA_SET:case O.o.MANDELBOX:case O.o.SIERPINSKI_PYRAMID:case O.o.MENGER_SPONGE:case O.o.DARK_KNIGHT:if(l<100*u.getBoundingRadius())return void this.setMusicFromSelection([this.musics.spacialWinds,this.musics.echoesOfTime]);break;case O.o.STAR:case O.o.NEUTRON_STAR:case O.o.TELLURIC_PLANET:case O.o.TELLURIC_SATELLITE:case O.o.GAS_PLANET:case O.o.CUSTOM:break;case O.o.SPACE_STATION:case O.o.SPACE_ELEVATOR:if((null===c||c.isDisabled())&&l<10*u.getBoundingRadius())return void this.setMusic(this.musics.equatorialComplex)}if(null!==c&&c.isEnabled()){var d=[this.musics.atlanteanTwilight,this.musics.infinitePerspective,this.musics.mesmerize];this.setMusicFromSelection(d);return}if(!a.isLanded()&&(null===c||c.isDisabled())){var h=[this.musics.thatZenMoment,this.musics.deepRelaxation,this.musics.peaceOfMind];this.setMusicFromSelection(h);return}if(i||a.isLanded()){var f=[this.musics.thatZenMoment,this.musics.deepRelaxation,this.musics.peaceOfMind,this.musics.mesmerize,this.musics.reawakening];this.setMusicFromSelection(f);return}this.setMusic(null)}}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),t}(),eT=n(54530),eA=n(4761),eL=n(55914),eO=n(70620),eI=n(70618),ek=n(74667),eM=n(96775),eV=n(33778),eR=n(68215),eD=n(85791),ex=n(49541),eN=n(90328),e_=n(14280),eB=n(24660),ej=n(32075),eU=n(15589);function eF(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}var eG=n(62341);let eW=n.p+"84ce2b6784367db0.webp",eZ=n.p+"8a1c03268bf466ec.webp";var ez=n(73252);let eY=n.p+"1a462202fcf3027a.webp",eK=n.p+"516b62e74a5c289b.webp",eH=n.p+"59c8c9e9e3e40806.webp",eX=n.p+"cffe491bb1a1152f.webp";function eJ(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}function eq(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function o(e){eJ(i,r,a,o,s,"next",e)}function s(e){eJ(i,r,a,o,s,"throw",e)}o(void 0)})}}function eQ(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function e$(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){var l=[s,u];if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,r=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){i=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){i.label=l[1];break}if(6===l[0]&&i.label<a[1]){i.label=a[1],a=l;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(l);break}a[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}var e0=function(){var e;function t(e,n){var r=this;if(!(this instanceof t))throw TypeError("Cannot call a class as a function");eQ(this,"htmlRoot",void 0),eQ(this,"cmdrList",void 0),eQ(this,"onLoadSaveObservable",new eD.y$),eQ(this,"soundPlayer",void 0),this.htmlRoot=document.createElement("div"),this.htmlRoot.classList.add("saveLoadingPanelContent"),this.soundPlayer=n;var a=document.createElement("div");a.id="dropFileZone",this.htmlRoot.appendChild(a);var i=document.createElement("p");i.innerText=ej.Z.t("sidePanel:dropASaveFileHere"),a.appendChild(i),a.addEventListener("dragover",function(e){if(e.preventDefault(),e.stopPropagation(),a.classList.add("dragover"),a.classList.remove("invalid"),null===e.dataTransfer)throw Error("event.dataTransfer is null");e.dataTransfer.dropEffect="copy"}),a.addEventListener("dragleave",function(e){e.preventDefault(),e.stopPropagation(),a.classList.remove("dragover")}),a.addEventListener("drop",function(t){return eq(function(){var n;return e$(this,function(r){switch(r.label){case 0:if(t.preventDefault(),t.stopPropagation(),a.classList.remove("dragover"),null===t.dataTransfer)throw Error("event.dataTransfer is null");if(0===t.dataTransfer.files.length)throw Error("event.dataTransfer.files is empty");if(void 0!==(n=t.dataTransfer.files[0]))return[3,2];return[4,(0,eR.UX)("No file dropped",this.soundPlayer)];case 1:case 3:return r.sent(),[2];case 2:return[4,this.loadSaveFile(n,e)]}})}).call(r)}),a.addEventListener("click",function(){r.soundPlayer.playNow(eT.k6.CLICK);var t=document.createElement("input");t.type="file",t.accept="application/json",t.onchange=function(){return eq(function(){var n;return e$(this,function(r){switch(r.label){case 0:if(null===t.files)throw Error("fileInput.files is null");if(0===t.files.length)throw Error("fileInput.files is empty");if(void 0!==(n=t.files[0]))return[3,2];return[4,(0,eR.UX)("No file selected",this.soundPlayer)];case 1:case 3:return r.sent(),[2];case 2:return[4,this.loadSaveFile(n,e)]}})}).call(r)},t.click()}),this.cmdrList=document.createElement("div"),this.cmdrList.classList.add("cmdrList"),this.htmlRoot.appendChild(this.cmdrList)}return e=[{key:"populateCmdrList",value:function(e,t){var n=this;this.cmdrList.innerHTML="";var r=t.getCmdrUuids(),a=new Map,i=!0,o=!1,s=void 0;try{for(var u,l=r[Symbol.iterator]();!(i=(u=l.next()).done);i=!0){var c=u.value,d=t.getSavesForCmdr(c);void 0!==d&&a.set(c,d.manual.concat(d.auto))}}catch(e){o=!0,s=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw s}}a.forEach(function(e){e.sort(function(e,t){return t.timestamp-e.timestamp})}),r.sort(function(e,t){var n,r,i=null==(n=a.get(e))?void 0:n.at(0),o=null==(r=a.get(t))?void 0:r.at(0);if(void 0===i||void 0===o)throw Error("aLatestSave or bLatestSave is undefined");return o.timestamp-i.timestamp}),r.forEach(function(r){var a=t.getSavesForCmdr(r);if(void 0!==a){var i=document.createElement("div");i.classList.add("cmdr"),n.cmdrList.appendChild(i);var o=a.auto.concat(a.manual);o.sort(function(e,t){return t.timestamp-e.timestamp});var s=o[0];if(void 0!==s){var u=document.createElement("div");u.classList.add("cmdrHeader"),i.appendChild(u);var l=document.createElement("div");l.classList.add("cmdrHeaderText"),u.appendChild(l);var c=document.createElement("h3");c.innerText=s.player.name,l.appendChild(c);var d=document.createElement("p");d.innerText=ej.Z.t("sidePanel:lastPlayedOn",{val:new Date(s.timestamp),formatParams:{val:{weekday:"long",year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"numeric"}}}),l.appendChild(d);var h=document.createElement("p");h.innerText=ej.Z.t("sidePanel:journeyedFor",{nbHours:Math.ceil(s.player.timePlayedSeconds/60/60)}),l.appendChild(h);var f=document.createElement("div");f.classList.add("cmdrHeaderButtons"),u.appendChild(f);var p=document.createElement("button");p.classList.add("icon","large"),p.addEventListener("click",function(){n.soundPlayer.playNow(eT.k6.CLICK),n.onLoadSaveObservable.notifyObservers(s)}),f.appendChild(p);var m=document.createElement("img");m.src=eH,p.appendChild(m);var y=document.createElement("button");y.classList.add("icon","large"),y.addEventListener("click",function(){return eq(function(){var e,t;return e$(this,function(n){switch(n.label){case 0:if(e=this,this.soundPlayer.playNow(eT.k6.CLICK),null!==(t=(0,v.z0)(s)))return[3,2];return[4,(0,eR.UX)("Could not create a URL from the save file.",this.soundPlayer)];case 1:case 3:return n.sent(),[2];case 2:return[4,navigator.clipboard.writeText(t.toString()).then(function(){(0,eG.sc)(eG.OO.GENERAL,eG.sh.SUCCESS,ej.Z.t("notifications:copiedToClipboard"),5e3,e.soundPlayer)})]}})}).call(n)}),f.appendChild(y);var b=document.createElement("img");b.src=eK,y.appendChild(b);var g=document.createElement("button");g.classList.add("icon","large"),g.addEventListener("click",function(){return eq(function(){var e;return e$(this,function(n){switch(n.label){case 0:return this.soundPlayer.playNow(eT.k6.CLICK),[4,(0,eR.We)(ej.Z.t("sidePanel:cmdrNameChangePrompt"),s.player.name,this.soundPlayer)];case 1:if(null===(e=n.sent()))return[2];return t.renameCmdr(r,e),c.innerText=e,t.save(),[2]}})}).call(n)}),f.appendChild(g);var S=document.createElement("img");S.src=ez,g.appendChild(S);var w=document.createElement("div");w.classList.add("savesList"),w.classList.add("hidden"),i.appendChild(w),o.forEach(function(r){var i=n.createSaveDiv(r,a.auto.includes(r),e,t);w.appendChild(i)});var E=document.createElement("img");E.src=eY;var P=document.createElement("img");P.src=eW;var C=document.createElement("button");C.classList.add("expandButton","icon","large"),C.appendChild(E),C.addEventListener("click",function(){n.soundPlayer.playNow(eT.k6.CLICK),w.classList.toggle("hidden"),C.innerHTML="",C.appendChild(w.classList.contains("hidden")?E:P)}),f.appendChild(C)}}})}},{key:"createSaveDiv",value:function(e,t,n,r){var a,i=this,o=document.createElement("div");o.classList.add("saveContainer");var s=document.createElement("div");s.classList.add("saveText"),o.appendChild(s);var u=document.createElement("p");u.innerText=(t?"[Auto] ":"")+new Date(e.timestamp).toLocaleString(),s.appendChild(u);var l=document.createElement("p"),c="inSpaceship"===e.playerLocation.type?e.shipLocations[e.playerLocation.shipId]:e.playerLocation;if(void 0===c)throw Error("locationToUse is undefined");if("inSpaceship"===c.type)throw Error("Spaceship inside a spaceship is not supported yet");var d="atStation"===c.type,h=n.getObjectModelByUniverseId(c.universeObjectId);l.innerText=ej.Z.t(d?"sidePanel:landedAt":"sidePanel:near",{location:null!=(a=null==h?void 0:h.name)?a:ej.Z.t("sidePanel:locationNotFound"),interpolation:{escapeValue:!1}}),s.appendChild(l);var f=document.createElement("div");f.classList.add("saveButtons"),o.appendChild(f);var p=document.createElement("button");p.classList.add("icon","large"),p.addEventListener("click",function(){i.soundPlayer.playNow(eT.k6.CLICK),i.onLoadSaveObservable.notifyObservers(e)}),f.appendChild(p);var m=document.createElement("img");m.src=eH,p.appendChild(m);var y=document.createElement("button");y.classList.add("icon","large"),y.addEventListener("click",function(){return eq(function(){var t,n;return e$(this,function(r){switch(r.label){case 0:if(t=this,this.soundPlayer.playNow(eT.k6.CLICK),null!==(n=(0,v.z0)(e)))return[3,2];return[4,(0,eR.UX)("Could not create a URL from the save file.",this.soundPlayer)];case 1:case 3:return r.sent(),[2];case 2:return[4,navigator.clipboard.writeText(n.toString()).then(function(){(0,eG.sc)(eG.OO.GENERAL,eG.sh.INFO,ej.Z.t("notifications:copiedToClipboard"),5e3,t.soundPlayer)})]}})}).call(i)}),f.appendChild(y);var b=document.createElement("img");b.src=eK,y.appendChild(b);var g=document.createElement("button");g.classList.add("icon","large"),g.addEventListener("click",function(){i.soundPlayer.playNow(eT.k6.CLICK);var t=new Blob([JSON.stringify(e)],{type:"application/json"}),n=URL.createObjectURL(t),r=document.createElement("a");r.href=n,r.download="".concat(e.player.name,"_").concat(e.timestamp,".json"),r.click(),URL.revokeObjectURL(n)}),f.appendChild(g);var S=document.createElement("img");S.src=eZ,g.appendChild(S);var w=document.createElement("button");w.classList.add("danger","icon","large"),w.addEventListener("click",function(){return eq(function(){var t,n,a;return e$(this,function(i){switch(i.label){case 0:return this.soundPlayer.playNow(eT.k6.CLICK),[4,(0,eR.bG)(ej.Z.t("sidePanel:deleteSavePrompt"),this.soundPlayer)];case 1:if(!i.sent()||(r.deleteSaveForCmdr(e.player.uuid,e),void 0===(t=r.getSavesForCmdr(e.player.uuid))))return[2];return 0===t.auto.length&&0===t.manual.length&&(r.deleteCmdr(e.player.uuid),null==(a=o.parentElement)||null==(n=a.parentElement)||n.remove()),o.remove(),r.save(),[2]}})}).call(i)}),f.appendChild(w);var E=document.createElement("img");return E.src=eX,w.appendChild(E),o}},{key:"loadSaveFile",value:function(e,t){return eq(function(){var n;return e$(this,function(r){switch(r.label){case 0:var a;return[4,(a=function(){return function(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){var l=[s,u];if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,r=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){i=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){i.label=l[1];break}if(6===l[0]&&i.label<a[1]){i.label=a[1],a=l;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(l);break}a[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}(this,function(n){return[2,new Promise(function(n){var r=new FileReader;r.onload=function(e){if(null===e.target)throw Error("event.target is null");var r,a=e.target.result;if(null===a)throw Error("data is null");if(null!=(r=ArrayBuffer)&&"undefined"!=typeof Symbol&&r[Symbol.hasInstance]?!!r[Symbol.hasInstance](a):a instanceof r)throw Error("data is an ArrayBuffer");var i=(0,m.o)(a);if(null===i)return void n((0,y.c)({type:p.b.INVALID_JSON}));n((0,v.Yn)(i,t))},r.readAsText(e)})]})},function(){var e=this,t=arguments;return new Promise(function(n,r){var i=a.apply(e,t);function o(e){eF(i,n,r,o,s,"next",e)}function s(e){eF(i,n,r,o,s,"throw",e)}o(void 0)})})()];case 1:if((n=r.sent()).success)return[3,3];return console.error(n.error),[4,(0,eR.UX)((0,p.M)(n.error),this.soundPlayer)];case 2:return r.sent(),[2,n];case 3:return this.onLoadSaveObservable.notifyObservers(n.value),[2,n]}})}).call(this)}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),t}(),e1=n(43999),e2=n(2607),e3=n(58237),e4=n(52653),e6=n(58672),e5=n(11508),e7=n(12428),e8=n(94117),e9=n(94997),te=[eL.S,e9.B,e7.v,e5.m,e4.V,e6.H,e8.v],tt=n(30073),tn=n(91307);function tr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function ta(e,t){return null!=t&&"undefined"!=typeof Symbol&&t[Symbol.hasInstance]?!!t[Symbol.hasInstance](e):e instanceof t}function ti(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n,r,a=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=a){var i=[],o=!0,s=!1;try{for(a=a.call(e);!(o=(n=a.next()).done)&&(i.push(n.value),!t||i.length!==t);o=!0);}catch(e){s=!0,r=e}finally{try{o||null==a.return||a.return()}finally{if(s)throw r}}return i}}(e,t)||function(e,t){if(e){if("string"==typeof e)return tr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if("Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tr(e,t)}}(e,t)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}var to=n(86950),ts=n(24432),tu=n(16050),tl=n(31328);function tc(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var td=function e(){var t=this;if(!(this instanceof e))throw TypeError("Cannot call a class as a function");tc(this,"htmlRoot",void 0),tc(this,"onTutorialSelected",new eD.y$),tc(this,"availableTutorials",void 0),this.htmlRoot=document.createElement("div"),this.htmlRoot.classList.add("tutorialsMenuContainer"),this.availableTutorials=[new to.d,new tl.b,new tu.D,new ts.L],this.availableTutorials.forEach(function(e){var n=document.createElement("div");n.classList.add("tutorial");var r=document.createElement("h2");r.textContent=e.getTitle(),n.appendChild(r);var a=document.createElement("img");a.src=e.coverImageSrc,a.alt=e.getTitle(),n.appendChild(a);var i=document.createElement("p");i.textContent=e.getDescription(),n.appendChild(i),t.htmlRoot.appendChild(n),n.addEventListener("click",function(){t.onTutorialSelected.notifyObservers(e)})});var n=document.createElement("p");n.classList.add("moreWillCome"),n.textContent=ej.Z.t("tutorials:common:moreWillComeSoon"),this.htmlRoot.appendChild(n)};function th(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var tf=((r={})[r.LOAD_SAVE=0]="LOAD_SAVE",r[r.SETTINGS=1]="SETTINGS",r[r.TUTORIALS=2]="TUTORIALS",r[r.CONTRIBUTE=3]="CONTRIBUTE",r[r.CREDITS=4]="CREDITS",r[r.ABOUT=5]="ABOUT",r),tv=function(){var e;function t(e,n,r){if(!(this instanceof t))throw TypeError("Cannot call a class as a function");th(this,"activeRightPanel",null),th(this,"loadSavePanel",void 0),th(this,"loadSavePanelContent",void 0),th(this,"settingsPanel",void 0),th(this,"tutorialsPanel",void 0),th(this,"tutorialsPanelContent",void 0),th(this,"contributePanel",void 0),th(this,"creditsPanel",void 0),th(this,"aboutPanel",void 0),th(this,"starSystemDatabase",void 0),th(this,"saveManager",void 0),this.starSystemDatabase=e,this.saveManager=n;var a=document.getElementById("loadSavePanel");if(null===a)throw Error("#loadSavePanel does not exist!");this.loadSavePanel=a,this.loadSavePanelContent=new e0(e,r),this.loadSavePanel.appendChild(this.loadSavePanelContent.htmlRoot),this.settingsPanel=function(){var e=document.getElementById("settingsPanel");if(null===e)throw Error("#settings does not exist!");return(0,tt.x)().then(function(t){te.forEach(function(n){var r=document.createElement("div");r.classList.add("map");var a=document.createElement("h3");a.textContent=n.name.replace(/([A-Z])/g," $1").trim(),r.appendChild(a);var i=!0,o=!1,s=void 0;try{for(var u,l=Object.entries(n.map)[Symbol.iterator]();!(i=(u=l.next()).done);i=!0)!function(){var e=ti(u.value,2),n=e[0],a=e[1],i=new Map;(ta(a,e1.Z)?a.bindings:a.action.bindings).forEach(function(e){if(ta(e.control,e3.Z))(0,tn.cs)(e.control,t).forEach(function(e){var t,n=ti(e,2),r=n[0],a=n[1];i.has(r)||i.set(r,[]),null==(t=i.get(r))||t.push(a)});else if(ta(e.control,e2.N3)){var n,r=(0,tn.x_)(e.control,t);i.has("BUTTON")||i.set("BUTTON",[]),null==(n=i.get("BUTTON"))||n.push(r)}else if(ta(e.control,e2.LV))(0,tn.C9)(e.control,t).forEach(function(e){var t,n=ti(e,2),r=n[0],a=n[1];i.has(r)||i.set(r,[]),null==(t=i.get(r))||t.push(a)});else if(ta(e.control,e2.Z9))(0,tn.JT)(e.control).forEach(function(e){var t,n=ti(e,2),r=n[0],a=n[1];i.has(r)||i.set(r,[]),null==(t=i.get(r))||t.push(a)});else if(ta(e.control,e2.xE))(0,tn.gG)().forEach(function(e){var t,n=ti(e,2),r=n[0],a=n[1];i.has(r)||i.set(r,[]),null==(t=i.get(r))||t.push(a)});else throw Error("Unknown control type")});var o=document.createElement("div"),s=document.createElement("p");if(s.textContent=n.replace(/([A-Z])/g," $1").trim(),o.appendChild(s),1===i.size){o.classList.add("actionSingle");var l=document.createElement("div");l.classList.add("valuesContainer");var c=!0,d=!1,h=void 0;try{for(var f,v=i.values()[Symbol.iterator]();!(c=(f=v.next()).done);c=!0)f.value.forEach(function(e){var t=document.createElement("p");t.innerText=e,l.appendChild(t)})}catch(e){d=!0,h=e}finally{try{c||null==v.return||v.return()}finally{if(d)throw h}}o.appendChild(l)}else o.classList.add("actionMultiple"),i.forEach(function(e,t){var n=document.createElement("div");n.classList.add("subAction");var r=document.createElement("p");r.textContent=t;var a=document.createElement("div");a.classList.add("valuesContainer"),e.forEach(function(e){var t=document.createElement("p");t.innerText=e,a.appendChild(t)}),n.appendChild(r),n.appendChild(a),o.appendChild(n)});r.appendChild(o)}()}catch(e){o=!0,s=e}finally{try{i||null==l.return||l.return()}finally{if(o)throw s}}e.appendChild(r)})}),e}();var i=document.getElementById("tutorials");if(null===i)throw Error("#tutorials does not exist!");this.tutorialsPanel=i,this.tutorialsPanelContent=new td,this.tutorialsPanel.appendChild(this.tutorialsPanelContent.htmlRoot);var o=document.getElementById("contribute");if(null===o)throw Error("#contribute does not exist!");this.contributePanel=o;var s=document.getElementById("credits");if(null===s)throw Error("#credits does not exist!");this.creditsPanel=s;var u=document.getElementById("about");if(null===u)throw Error("#about does not exist!");this.aboutPanel=u}return e=[{key:"panelFromType",value:function(e){var t=null;switch(e){case 0:t=this.loadSavePanel;break;case 1:t=this.settingsPanel;break;case 2:t=this.tutorialsPanel;break;case 3:t=this.contributePanel;break;case 4:t=this.creditsPanel;break;case 5:t=this.aboutPanel}return t}},{key:"toggleActivePanel",value:function(e){var t=this.panelFromType(e);if(this.activeRightPanel===t)return void this.hideActivePanel();0===e&&this.loadSavePanelContent.populateCmdrList(this.starSystemDatabase,this.saveManager),null!==this.activeRightPanel&&this.hideActivePanel(),this.activeRightPanel=t,t.classList.add("visible")}},{key:"hideActivePanel",value:function(){null!==this.activeRightPanel&&(this.activeRightPanel.classList.remove("visible"),this.activeRightPanel=null)}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),t}();function tp(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}function tm(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function o(e){tp(i,r,a,o,s,"next",e)}function s(e){tp(i,r,a,o,s,"throw",e)}o(void 0)})}}function ty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tb(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){var l=[s,u];if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,r=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){i=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){i.label=l[1];break}if(6===l[0]&&i.label<a[1]){i.label=a[1],a=l;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(l);break}a[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}var tg=function(){var e;function t(e,n,r,a){var i=this;if(!(this instanceof t))throw TypeError("Cannot call a class as a function");ty(this,"scene",void 0),ty(this,"controls",void 0),ty(this,"starSystemView",void 0),ty(this,"starSystemModel",void 0),ty(this,"onStartObservable",new eD.y$),ty(this,"onContributeObservable",new eD.y$),ty(this,"onCreditsObservable",new eD.y$),ty(this,"onAboutObservable",new eD.y$),ty(this,"htmlRoot",void 0),ty(this,"title",void 0),ty(this,"version",void 0),ty(this,"sidePanels",void 0),ty(this,"universeObjectId",void 0),ty(this,"startAnimationDurationSeconds",5),this.sidePanels=e,this.starSystemView=n,this.scene=this.starSystemView.scene,this.controls=this.starSystemView.getDefaultControls(),this.starSystemView.setUIEnabled(!1);var o=r.getSystemModelFromCoordinates({localX:.49137314641446483,localY:.48043087077347135,localZ:.38353311777279386,starSectorX:0,starSectorY:0,starSectorZ:0});if(null===o)throw Error("Cannot find system");var s=o.planets.at(1);if(void 0===s)throw Error("Cannot find planet with index 2");this.universeObjectId=(0,M.D2)(s,o),this.starSystemModel=o;var u=document.getElementById("mainMenu");if(null===u)throw Error("#mainMenu does not exist!");this.htmlRoot=u,this.htmlRoot.style.display="none";var l=document.querySelector("#mainMenu h1");if(null===l)throw Error("#mainMenu h1 does not exist!");this.title=l;var c=document.getElementById("version");if(null===c)throw Error("#version does not exist!");var d=c.querySelector("a");if(null===d)throw Error("version link does not exist!");d.textContent="Alpha ".concat(eU.i8),this.version=c,document.querySelectorAll("#menuItems li").forEach(function(e){e.addEventListener("mouseenter",function(){a.playNow(eT.k6.HOVER)}),e.addEventListener("click",function(){a.playNow(eT.k6.CLICK)})}),document.querySelectorAll("#mainMenu *[data-i18n]").forEach(function(e){var t=e.getAttribute("data-i18n");if(null===t)throw Error("data-i18n attribute is null");e.textContent=ej.Z.t(t)});var h=document.getElementById("startButton");if(null===h)throw Error("#startButton does not exist!");h.addEventListener("click",function(){i.startAnimation(function(){return i.onStartObservable.notifyObservers()})});var f=document.getElementById("loadSaveButton");if(null===f)throw Error("#loadSaveButton does not exist!");f.addEventListener("click",function(){i.sidePanels.toggleActivePanel(tf.LOAD_SAVE)}),this.sidePanels.loadSavePanelContent.onLoadSaveObservable.add(function(){i.hide()});var v=document.getElementById("settingsButton");if(null===v)throw Error("#settingsButton does not exist!");v.addEventListener("click",function(){i.sidePanels.toggleActivePanel(tf.SETTINGS)});var p=document.getElementById("tutorialsButton");if(null===p)throw Error("#tutorialsButton does not exist!");p.addEventListener("click",function(){i.sidePanels.toggleActivePanel(tf.TUTORIALS)});var m=document.getElementById("contributeButton");if(null===m)throw Error("#contributeButton does not exist!");m.addEventListener("click",function(){i.sidePanels.toggleActivePanel(tf.CONTRIBUTE),i.onContributeObservable.notifyObservers()});var y=document.getElementById("creditsButton");if(null===y)throw Error("#creditsButton does not exist!");y.addEventListener("click",function(){i.sidePanels.toggleActivePanel(tf.CREDITS),i.onCreditsObservable.notifyObservers()});var b=document.getElementById("aboutButton");if(null===b)throw Error("#aboutButton does not exist!");b.addEventListener("click",function(){i.sidePanels.toggleActivePanel(tf.ABOUT),i.onAboutObservable.notifyObservers()})}return e=[{key:"init",value:function(){return tm(function(){var e;return tb(this,function(t){switch(t.label){case 0:return e=this,[4,this.starSystemView.loadStarSystem(this.starSystemModel)];case 1:return t.sent(),this.starSystemView.onInitStarSystem.addOnce(function(){return tm(function(){var e,t;return tb(this,function(n){switch(n.label){case 0:return[4,this.starSystemView.switchToDefaultControls(!1)];case 1:if(n.sent(),e=this.starSystemModel.stellarObjects[0].type===O.o.BLACK_HOLE?8:2,void 0===(t=this.starSystemView.getStarSystem().getOrbitalObjectById(this.universeObjectId.idInSystem)))throw Error("Could not find object with ID ".concat(JSON.stringify(this.universeObjectId)));return(0,eB.xM)(this.controls,t,this.starSystemView.getStarSystem(),e),[2]}})}).call(e)}),this.starSystemView.targetCursorLayer.setEnabled(!1),this.htmlRoot.style.display="block",[2]}})}).call(this)}},{key:"startAnimation",value:function(e){var t=this;this.sidePanels.hideActivePanel();var n=this.starSystemView.getStarSystem(),r=(0,e_.cs)(this.controls.getTransform()),a=n.getOrbitalObjectById(this.universeObjectId.idInSystem),i=n.getCelestialBodies().find(function(e){return e===a});if(void 0===i)throw Error("No corresponding celestial body found");var o=i.getTransform().getAbsolutePosition().subtract(this.controls.getTransform().getAbsolutePosition()).normalize(),u=s.P.Cross(r,o),l=s.P.GetAngleBetweenVectors(r,o,u),c=(0,eB._T)(i,n,.9),d=new ex._(this.controls.getTransform(),u,l,this.startAnimationDurationSeconds),h=new eN.J(this.controls.getTransform(),c,this.startAnimationDurationSeconds);this.title.animate([{marginTop:this.title.style.marginTop,opacity:1},{marginTop:"30vh",opacity:0}],{duration:1e3*this.startAnimationDurationSeconds,easing:"ease-in-out",fill:"forwards"});var f=function(){var r=t.scene.getEngine().getDeltaTime()/1e3;if(h.isFinished()||h.update(r),d.isFinished()){t.scene.onBeforePhysicsObservable.removeCallback(f),t.htmlRoot.style.display="none",t.starSystemView.setUIEnabled(!0),e();return}d.update(r),t.controls.getActiveCamera().getViewMatrix(),n.applyFloatingOrigin(),t.starSystemView.postProcessManager.update(0),n.updateShaders(0)};this.scene.onBeforePhysicsObservable.add(f),this.hideMenu(),this.hideVersion()}},{key:"hideVersion",value:function(){this.version.style.transform="translateY(100%)"}},{key:"hideMenu",value:function(){var e=document.getElementById("menuItems");if(null===e)throw Error("#menuItems does not exist!");e.style.left="-20%"}},{key:"hide",value:function(){this.hideVersion(),this.hideMenu(),this.sidePanels.hideActivePanel(),this.htmlRoot.style.display="none"}},{key:"isVisible",value:function(){return"none"!==this.htmlRoot.style.display}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),t}();function tS(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var tw=function(){var e;function t(e,n){var r=this;if(!(this instanceof t))throw TypeError("Cannot call a class as a function");tS(this,"rootNode",void 0),tS(this,"mask",void 0),tS(this,"screenshotButton",void 0),tS(this,"shareButton",void 0),tS(this,"contributeButton",void 0),tS(this,"tutorialsButton",void 0),tS(this,"settingsButton",void 0),tS(this,"loadButton",void 0),tS(this,"saveButton",void 0),tS(this,"resumeButton",void 0),tS(this,"sidePanels",void 0),tS(this,"onScreenshot",new eD.y$),tS(this,"onShare",new eD.y$),tS(this,"onSave",new eD.y$),tS(this,"onResume",new eD.y$),this.sidePanels=e,this.mask=document.createElement("div"),this.mask.id="pauseMask",this.rootNode=document.createElement("ul"),this.rootNode.id="pauseMenu",this.rootNode.classList.add("leftSideMenu");var a=function(e,t){var n=document.createElement("li");return n.id=e,n.classList.add("button"),n.innerText=ej.Z.t(t),r.rootNode.appendChild(n),n};this.resumeButton=a("resumeButton","pauseMenu:resume"),this.saveButton=a("saveButton","pauseMenu:save"),this.loadButton=a("loadButton","pauseMenu:load"),this.tutorialsButton=a("pauseTutorialsButton","pauseMenu:tutorials"),this.settingsButton=a("pauseSettingsButton","pauseMenu:settings"),this.contributeButton=a("pauseContributeButton","pauseMenu:contribute"),this.screenshotButton=a("screenshotButton","pauseMenu:screenshot"),this.shareButton=a("shareButton","pauseMenu:share"),this.mask.appendChild(this.rootNode),document.body.appendChild(this.mask),this.screenshotButton.addEventListener("click",function(){return r.onScreenshot.notifyObservers()}),this.shareButton.addEventListener("click",function(){return r.onShare.notifyObservers()}),this.contributeButton.addEventListener("click",function(){n.playNow(eT.k6.CLICK),r.sidePanels.toggleActivePanel(tf.CONTRIBUTE)}),this.tutorialsButton.addEventListener("click",function(){n.playNow(eT.k6.CLICK),r.sidePanels.toggleActivePanel(tf.TUTORIALS)}),this.settingsButton.addEventListener("click",function(){n.playNow(eT.k6.CLICK),r.sidePanels.toggleActivePanel(tf.SETTINGS)}),this.loadButton.addEventListener("click",function(){n.playNow(eT.k6.CLICK),r.sidePanels.toggleActivePanel(tf.LOAD_SAVE)}),this.saveButton.addEventListener("click",function(){return r.onSave.notifyObservers()}),this.resumeButton.addEventListener("click",function(){return r.onResume.notifyObservers()}),this.rootNode.querySelectorAll("li").forEach(function(e){e.addEventListener("mouseenter",function(){n.playNow(eT.k6.HOVER)}),e.addEventListener("click",function(){n.playNow(eT.k6.CLICK)})}),this.setVisibility(!1)}return e=[{key:"setVisibility",value:function(e){this.rootNode.style.display=e?"grid":"none",this.mask.style.display=e?"block":"none",e||this.sidePanels.hideActivePanel()}},{key:"isVisible",value:function(){return"none"!==this.rootNode.style.display}}],function(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}(t.prototype,e),t}(),tE=n(19577),tP=n(91822),tC=n(76473);function tT(e,t,n,r,a,i,o){try{var s=e[i](o),u=s.value}catch(e){n(e);return}s.done?t(u):Promise.resolve(u).then(r,a)}function tA(e){return function(){var t=this,n=arguments;return new Promise(function(r,a){var i=e.apply(t,n);function o(e){tT(i,r,a,o,s,"next",e)}function s(e){tT(i,r,a,o,s,"throw",e)}o(void 0)})}}function tL(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function tO(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function tI(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){var l=[s,u];if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,r=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){i=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){i.label=l[1];break}if(6===l[0]&&i.label<a[1]){i.label=a[1],a=l;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(l);break}a[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}var tk=function(){var e,t;function r(e,t,n,a,i,o,u,l,c){var d=this;if(!(this instanceof r))throw TypeError("Cannot call a class as a function");tO(this,"engine",void 0),tO(this,"assets",void 0),tO(this,"starSystemView",void 0),tO(this,"starMap",void 0),tO(this,"musicConductor",void 0),tO(this,"soundPlayer",void 0),tO(this,"tts",void 0),tO(this,"mainMenu",void 0),tO(this,"pauseMenu",void 0),tO(this,"sidePanels",void 0),tO(this,"tutorialLayer",void 0),tO(this,"activeView",void 0),tO(this,"state",0),tO(this,"videoRecorder",null),tO(this,"player",void 0),tO(this,"encyclopaedia",void 0),tO(this,"starSystemDatabase",void 0),tO(this,"saveManager",void 0),tO(this,"elapsedSeconds",0),tO(this,"autoSavePeriodSeconds",300),tO(this,"autoSaveTimerSeconds",0),tO(this,"isAutoSaveEnabled",!0),this.engine=t,this.assets=n,this.player=e,this.player.onNameChangedObservable.add(function(e){d.saveManager.renameCmdr(d.player.uuid,e),d.saveManager.save()}),this.starSystemDatabase=o,this.saveManager=u,this.encyclopaedia=i,this.player.discoveries.uploaded.forEach(function(e){return tA(function(){return tI(this,function(t){switch(t.label){case 0:return[4,this.encyclopaedia.contributeDiscoveryIfNew(e)];case 1:return t.sent(),[2]}})}).call(d)}),this.starSystemView=a,this.starSystemView.onBeforeJump.add(function(){d.createAutoSave()}),this.starSystemView.onAfterJump.add(function(){return tA(function(){var e;return tI(this,function(t){switch(t.label){case 0:if(e=this,this.createAutoSave(),this.player.tutorials.fuelScoopingCompleted)return[3,2];return[4,this.tutorialLayer.setTutorial(new ts.L)];case 1:t.sent(),this.tutorialLayer.onQuitTutorial.addOnce(function(){e.player.tutorials.fuelScoopingCompleted=!0}),t.label=2;case 2:return[2]}})}).call(d)}),this.starSystemView.onNewDiscovery.add(function(){d.createAutoSave()}),this.musicConductor=new eC(this.assets.audio.musics,this.starSystemView),this.soundPlayer=l,this.tts=c,this.starMap=new eI.s(this.player,this.engine,this.encyclopaedia,this.starSystemDatabase,this.soundPlayer),this.starMap.onTargetSetObservable.add(function(e){d.starSystemView.setSystemAsTarget(e)}),this.starMap.detachControl(),this.starSystemView.attachControl(),this.activeView=this.starSystemView,l.setInstanceMask(ew.S.STAR_SYSTEM_VIEW),this.tutorialLayer=new tE.b(this.soundPlayer),document.body.appendChild(this.tutorialLayer.root),this.sidePanels=new tv(this.starSystemDatabase,this.saveManager,this.soundPlayer),this.sidePanels.loadSavePanelContent.onLoadSaveObservable.add(function(e){t.onEndFrameObservable.addOnce(function(){return tA(function(){return tI(this,function(t){switch(t.label){case 0:return this.isPaused()&&this.createAutoSave(),[4,this.resume()];case 1:return t.sent(),this.starSystemView.setUIEnabled(!0),[4,this.loadSave(e)];case 2:return t.sent(),[2]}})}).call(d)})}),this.mainMenu=new tg(this.sidePanels,this.starSystemView,this.starSystemDatabase,this.soundPlayer),this.mainMenu.onStartObservable.add(function(){return tA(function(){var e,t,n;return tI(this,function(r){switch(r.label){case 0:return e=this,[4,this.tutorialLayer.setTutorial(new to.d)];case 1:return r.sent(),this.tutorialLayer.onQuitTutorial.addOnce(function(){e.player.tutorials.flightCompleted=!0}),[4,this.starSystemView.switchToSpaceshipControls()];case 2:return r.sent(),t=this.starSystemView.getSpaceshipControls().getTransform().getAbsolutePosition(),n=this.starSystemView.getStarSystem().getOrbitalFacilities().reduce(function(e,n){return s.P.DistanceSquared(t,n.getTransform().getAbsolutePosition())<s.P.DistanceSquared(t,e.getTransform().getAbsolutePosition())?n:e}),this.starSystemView.setTarget(n),this.createAutoSave(),[2]}})}).call(d)}),this.sidePanels.tutorialsPanelContent.onTutorialSelected.add(function(e){return tA(function(){return tI(this,function(t){switch(t.label){case 0:if(this.mainMenu.isVisible())return[3,2];return this.createAutoSave(),[4,(0,eR.bG)(ej.Z.t("tutorials:common:loadTutorialWillLeaveGame"),this.soundPlayer)];case 1:if(!t.sent())return[2];t.label=2;case 2:return this.sidePanels.hideActivePanel(),this.loadTutorial(e),[2]}})}).call(d)}),this.starSystemView.getSpaceshipControls().onToggleWarpDrive.add(function(e){return tA(function(){var t,n,r,a,i,o;return tI(this,function(u){switch(u.label){case 0:if(t=this,e||this.player.tutorials.stationLandingCompleted||null===(r=(n=this.starSystemView.getSpaceshipControls()).getClosestLandableFacility())||(a=n.getTransform().getAbsolutePosition(),i=r.getTransform().position,o=10*r.getBoundingRadius(),s.P.DistanceSquared(a,i)>Math.pow(o,2)))return[2];return[4,this.tutorialLayer.setTutorial(new tl.b)];case 1:return u.sent(),this.tutorialLayer.onQuitTutorial.addOnce(function(){t.player.tutorials.stationLandingCompleted=!0}),[2]}})}).call(d)}),this.starSystemView.getSpaceshipControls().onCompleteLanding.add(function(){d.createAutoSave()}),this.starSystemView.onInitStarSystem.add(function(){var e=d.starSystemView.getStarSystem().model;d.starMap.setCurrentStarSystem(e.coordinates)}),this.starSystemView.spaceStationLayer.onTakeOffObservable.add(function(){return tA(function(){var e;return tI(this,function(t){switch(t.label){case 0:if(e=this,this.player.tutorials.starMapCompleted)return[2];return[4,this.tutorialLayer.setTutorial(new tu.D)];case 1:return t.sent(),this.tutorialLayer.onQuitTutorial.addOnce(function(){e.player.tutorials.starMapCompleted=!0}),[2]}})}).call(d)}),this.pauseMenu=new tw(this.sidePanels,this.soundPlayer),this.pauseMenu.onResume.add(function(){return d.resume()}),this.pauseMenu.onScreenshot.add(function(){return d.takeScreenshot()}),this.pauseMenu.onShare.add(function(){d.engine.onEndFrameObservable.addOnce(function(){return tA(function(){var e,t,n;return tI(this,function(r){switch(r.label){case 0:if(e=this,(t=this.generateSaveData()).player.uuid=tC.Z.SHARED_POSITION_SAVE_UUID,null!==(n=(0,v.z0)(t)))return[3,2];return[4,(0,eR.UX)("Could not create a shareable link.",this.soundPlayer)];case 1:case 3:return r.sent(),[2];case 2:return[4,navigator.clipboard.writeText(n.toString()).then(function(){(0,eG.sc)(eG.OO.GENERAL,eG.sh.INFO,ej.Z.t("notifications:copiedToClipboard"),2e3,e.soundPlayer)})]}})}).call(d)})}),this.pauseMenu.onSave.add(function(){return tA(function(){return tI(this,function(e){switch(e.label){case 0:return[4,this.saveToLocalStorage()];case 1:return e.sent()?(0,eG.sc)(eG.OO.GENERAL,eG.sh.SUCCESS,ej.Z.t("notifications:saveOk"),2e3,this.soundPlayer):(0,eG.sc)(eG.OO.GENERAL,eG.sh.ERROR,ej.Z.t("notifications:cantSaveTutorial"),2e3,this.soundPlayer),[2]}})}).call(d)}),window.addEventListener("blur",function(){d.mainMenu.isVisible()||d.starSystemView.isLoadingSystem()||d.pause()}),window.addEventListener("mouseleave",function(){d.mainMenu.isVisible()||d.starSystemView.isLoadingSystem()||d.pause()}),window.addEventListener("resize",function(){d.engine.resize(!0)}),window.addEventListener("beforeunload",function(){d.mainMenu.isVisible()||d.createAutoSave()}),eL.S.map.toggleStarMap.on("complete",function(){return tA(function(){return tI(this,function(e){switch(e.label){case 0:if(this.mainMenu.isVisible())return[2];return[4,this.toggleStarMap()];case 1:return e.sent(),[2]}})}).call(d)}),eL.S.map.screenshot.on("complete",function(){return tA(function(){return tI(this,function(e){switch(e.label){case 0:if(this.mainMenu.isVisible())return[2];return[4,this.takeScreenshot()];case 1:return e.sent(),[2]}})}).call(d)}),eL.S.map.videoCapture.on("complete",function(){return tA(function(){return tI(this,function(e){switch(e.label){case 0:if(this.mainMenu.isVisible())return[2];return[4,this.takeVideoCapture()];case 1:return e.sent(),[2]}})}).call(d)}),eL.S.map.togglePause.on("complete",function(){!d.mainMenu.isVisible()&&(d.isPaused()||d.pause())}),window.CosmosJourneyer=this}return e=[{key:"pause",value:function(){!this.isPaused()&&(this.mainMenu.isVisible()||(this.state=2,document.exitPointerLock(),this.activeView===this.starSystemView&&this.starSystemView.stopBackgroundSounds(),this.soundPlayer.playNow(eT.k6.OPEN_PAUSE_MENU),this.pauseMenu.setVisibility(!0)))}},{key:"resume",value:function(){return tA(function(){var e;return tI(this,function(t){switch(t.label){case 0:if(!this.isPaused())return[2];if(this.state=1,this.soundPlayer.playNow(eT.k6.CLICK),this.pauseMenu.setVisibility(!1),!(this.activeView===this.starSystemView&&this.starSystemView.scene.getActiveControls().shouldLockPointer()))return[3,2];return[4,null==(e=this.engine.getRenderingCanvas())?void 0:e.requestPointerLock()];case 1:t.sent(),t.label=2;case 2:return[2]}})}).call(this)}},{key:"isPaused",value:function(){return 2===this.state}},{key:"init",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return tA(function(){var t;return tI(this,function(n){switch(n.label){case 0:if(t=this,e)return[3,2];return[4,this.mainMenu.init()];case 1:n.sent(),n.label=2;case 2:return this.starSystemView.initStarSystem(),this.engine.runRenderLoop(function(){var e=t.engine.getDeltaTime()/1e3;t.elapsedSeconds+=e,t.player.timePlayedSeconds+=e,t.engine.loadingScreen.setProgressPercentage(100*t.starSystemView.loader.getLoadingProgress()),t.autoSaveTimerSeconds+=e,t.autoSaveTimerSeconds>=t.autoSavePeriodSeconds&&(t.autoSaveTimerSeconds%=t.autoSavePeriodSeconds,t.mainMenu.isVisible()||t.starSystemView.isJumpingBetweenSystems()||t.createAutoSave()),(0,eG.BX)(e),t.musicConductor.update(t.isPaused(),t.activeView===t.starSystemView,t.mainMenu.isVisible(),e),t.soundPlayer.update(),t.tts.update(),t.isPaused()||t.activeView.render()}),this.state=1,[2]}})}).call(this)}},{key:"toggleStarMap",value:function(){return tA(function(){var e,t;return tI(this,function(n){switch(n.label){case 0:if(this.activeView!==this.starSystemView)return[3,1];return this.soundPlayer.setInstanceMask(ew.S.STAR_MAP_VIEW),this.starSystemView.targetCursorLayer.setEnabled(!1),document.exitPointerLock(),this.starSystemView.detachControl(),this.starMap.attachControl(),e=this.starMap,this.activeView=e,e.focusOnCurrentSystem(),[3,3];case 1:if(this.starMap.detachControl(),this.starSystemView.attachControl(),this.soundPlayer.setInstanceMask(ew.S.STAR_SYSTEM_VIEW),this.activeView=this.starSystemView,!this.starSystemView.scene.getActiveControls().shouldLockPointer())return[3,3];return[4,null==(t=this.engine.getRenderingCanvas())?void 0:t.requestPointerLock()];case 2:n.sent(),n.label=3;case 3:return[2]}})}).call(this)}},{key:"takeScreenshot",value:function(){return tA(function(){var e;return tI(this,function(t){switch(t.label){case 0:if(null!==(e=this.activeView.getMainScene().activeCamera))return[3,2];return[4,(0,eR.UX)("Cannot take screenshot: camera is null",this.soundPlayer)];case 1:return t.sent(),[2,!1];case 2:return u.w1.CreateScreenshot(this.engine,e,{precision:1}),[2,!0]}})}).call(this)}},{key:"takeVideoCapture",value:function(){return tA(function(){return tI(this,function(e){switch(e.label){case 0:if(!l.S.IsSupported(this.engine))return console.warn("Your browser does not support video recording!"),[2];if(null===this.videoRecorder&&(this.videoRecorder=new l.S(this.engine,{fps:60,recordChunckSize:3e6,mimeType:"video/webm;codecs=h264"})),!this.videoRecorder.isRecording)return[3,1];return this.videoRecorder.stopRecording(),[3,3];case 1:return[4,this.videoRecorder.startRecording("planetEngine.webm",Number(prompt("Enter video duration in seconds","10"))).then()];case 2:e.sent(),e.label=3;case 3:return[2]}})}).call(this)}},{key:"getCurrentUniverseCoordinates",value:function(e){var t=this.starSystemView.getStarSystem(),n=e.getAbsolutePosition(),r=t.getNearestOrbitalObject(n),a=(0,M.D2)(r.model,t.model),i=r.getTransform().computeWorldMatrix(!0).clone().invert(),o=s.P.TransformCoordinates(n,i);o.length()<1.1*r.getBoundingRadius()&&o.copyFromFloats(0,0,5*r.getBoundingRadius());var u=e.absoluteRotationQuaternion,l=r.getTransform().absoluteRotationQuaternion.clone().invert(),c=u.multiply(l);return{type:"relative",universeObjectId:a,position:{x:o.x,y:o.y,z:o.z},rotation:{x:c.x,y:c.y,z:c.z,w:c.w}}}},{key:"generateSaveData",value:function(){var e=this.starSystemView.getSpaceshipControls(),t=e.getSpaceship(),n=this.getCurrentUniverseCoordinates(e.getTransform()),r=t.isLandedAtFacility()?{type:"atStation",universeObjectId:n.universeObjectId}:n;return{timestamp:Date.now(),player:eO.J.Serialize(this.player),playerLocation:{type:"inSpaceship",shipId:t.id},shipLocations:tO({},t.id,r)}}},{key:"saveToLocalStorage",value:function(){return tA(function(){var e,t,n,r,a,i,o;return tI(this,function(s){switch(s.label){case 0:if(this.player.uuid===tC.Z.TUTORIAL_SAVE_UUID)return[2,!1];if(this.player.uuid!==tC.Z.SHARED_POSITION_SAVE_UUID)return[3,2];return this.player.uuid=crypto.randomUUID(),n=(t=this.player).setName,[4,(0,eR.We)(ej.Z.t("spaceStation:cmdrNameChangePrompt"),this.player.getName(),this.soundPlayer)];case 1:n.apply(t,[null!=(e=s.sent())?e:"Python"]),s.label=2;case 2:return a=(r=this.generateSaveData()).player.uuid,(o=null!=(i=this.saveManager.getSavesForCmdr(a))?i:{manual:[],auto:[]}).manual.unshift(r),this.saveManager.setCmdrSaves(a,o),[2,this.saveManager.save()]}})}).call(this)}},{key:"setAutoSaveEnabled",value:function(e){this.isAutoSaveEnabled=e}},{key:"createAutoSave",value:function(){if(this.isAutoSaveEnabled){var e,t=this.generateSaveData(),n=t.player.uuid;if(n!==tC.Z.SHARED_POSITION_SAVE_UUID&&n!==tC.Z.TUTORIAL_SAVE_UUID){var r=null!=(e=this.saveManager.getSavesForCmdr(n))?e:{manual:[],auto:[t]};for(r.auto.unshift(t);r.auto.length>tC.Z.MAX_AUTO_SAVES;)r.auto.pop();this.saveManager.setCmdrSaves(n,r),this.saveManager.save(),this.autoSaveTimerSeconds=0}}}},{key:"downloadSaveFile",value:function(){var e=this;this.engine.onEndFrameObservable.addOnce(function(){var t=new Blob([JSON.stringify(e.generateSaveData())],{type:"application/json"}),n=URL.createObjectURL(t),r=document.createElement("a");r.href=n;var a=new Date().toLocaleString().replace(/[^0-9a-zA-Z]/g,"_");r.download="CMDR_".concat(e.player.getName(),"_").concat(a,".json"),r.click()})}},{key:"loadTutorial",value:function(e){var t=this;this.engine.onEndFrameObservable.addOnce(function(){return tA(function(){var t,n;return tI(this,function(r){switch(r.label){case 0:if(this.mainMenu.hide(),(t=e.getSaveData(this.starSystemDatabase)).success)return[3,2];return console.error(t.error),[4,(0,eR.UX)(ej.Z.t("The tutorial save has errors and could not be loaded! Check the console for more information."),this.soundPlayer)];case 1:return r.sent(),[2];case 2:return[4,this.loadSave(t.value)];case 3:return r.sent(),this.player.uuid=tC.Z.TUTORIAL_SAVE_UUID,[4,this.resume()];case 4:return r.sent(),[4,this.tutorialLayer.setTutorial(e)];case 5:return r.sent(),this.starSystemView.setUIEnabled(!0),n=this.starSystemView.getStarSystem().getNearestOrbitalObject(this.starSystemView.scene.getActiveControls().getTransform().getAbsolutePosition()),this.starSystemView.getSpaceshipControls().getTransform().lookAt(n.getTransform().getAbsolutePosition()),[2]}})}).call(t)})}},{key:"loadSave",value:function(e){return tA(function(){var t,n,r,a,i,o;return tI(this,function(s){switch(s.label){case 0:if(t=this,"inSpaceship"===(n=e.playerLocation).type)return[3,1];return r=n,[3,6];case 1:if(void 0!==(a=e.shipLocations[n.shipId]))return[3,3];return[4,(0,eR.UX)("Player is in spaceship, but said spaceship does not exist. The loading procedure has been aborted.",this.soundPlayer)];case 2:case 4:return s.sent(),[2];case 3:if("inSpaceship"!==a.type)return[3,5];return[4,(0,eR.UX)("Spaceship inside spaceships is not yet supported. The loading procedure has been aborted.",this.soundPlayer)];case 5:r=a,s.label=6;case 6:if(null!==(i=this.starSystemDatabase.getSystemModelFromCoordinates(r.universeObjectId.systemCoordinates)))return[3,8];return[4,(0,eR.UX)("Cannot load universe coordinates: system model not found. The loading procedure has been aborted.",this.soundPlayer)];case 7:return s.sent(),[2];case 8:return o=eO.J.Deserialize(e.player,this.starSystemDatabase),this.player.copyFrom(o,this.starSystemDatabase),this.player.discoveries.uploaded.forEach(function(e){return tA(function(){return tI(this,function(t){switch(t.label){case 0:return[4,this.encyclopaedia.contributeDiscoveryIfNew(e)];case 1:return t.sent(),[2]}})}).call(t)}),[4,this.starSystemView.resetPlayer()];case 9:return s.sent(),this.engine.loadingScreen.displayLoadingUI(),[4,this.starSystemView.loadStarSystem(i)];case 10:if(s.sent(),0!==this.state)return[3,12];return[4,this.init(!0)];case 11:return s.sent(),[3,13];case 12:this.starSystemView.initStarSystem(),s.label=13;case 13:if("inSpaceship"!==n.type)return[3,15];return[4,this.starSystemView.switchToSpaceshipControls()];case 14:return s.sent(),[3,17];case 15:return[4,this.starSystemView.switchToCharacterControls()];case 16:s.sent(),s.label=17;case 17:return[4,this.loadLocation(r)];case 18:return s.sent(),this.starSystemView.getSpaceshipControls().getActiveCamera().getViewMatrix(!0),this.starSystemView.getStarSystem().applyFloatingOrigin(),this.engine.loadingScreen.hideLoadingUI(),void 0!==this.player.currentItinerary[1]&&this.starSystemView.setSystemAsTarget(this.player.currentItinerary[1]),[2]}})}).call(this)}},{key:"loadLocation",value:function(e){return tA(function(){return tI(this,function(t){switch(t.label){case 0:if("relative"!==e.type)return[3,2];return[4,this.loadRelativeLocation(e)];case 1:return t.sent(),[3,4];case 2:if("atStation"!==e.type)return[3,4];return[4,this.loadAtStationLocation(e)];case 3:t.sent(),t.label=4;case 4:return[2]}})}).call(this)}},{key:"loadRelativeLocation",value:function(e){return tA(function(){var t,n,r,a,i,u;return tI(this,function(l){switch(l.label){case 0:if(t=this.starSystemView.scene.getActiveControls().getTransform(),void 0!==(r=(n=this.starSystemView.getStarSystem()).getOrbitalObjectById(e.universeObjectId.idInSystem)))return[3,2];return a=n.getStellarObjects()[0],(0,eB.gr)(a,new s.P(0,0,4*a.getBoundingRadius()),new o._f(0,0,0,1),t),[4,(0,eR.UX)("The object you are trying to spawn near to could not be found. You will spawn around the first stellar object of the system instead.",this.soundPlayer)];case 1:return l.sent(),[2];case 2:return(0,eB.gr)(r,new s.P(e.position.x,e.position.y,e.position.z),new o._f(e.rotation.x,e.rotation.y,e.rotation.z,e.rotation.w),t),(i=s.P.Distance(t.getAbsolutePosition(),r.getTransform().getAbsolutePosition()))<1.1*(u=r.getBoundingRadius())&&(i<.1?t.position.addInPlace(new s.P(0,0,5*u)):t.position.scaleInPlace(1.1*u/i)),this.starSystemView.targetCursorLayer.setTarget(r),this.starSystemView.spaceShipLayer.setTarget(r.getTransform()),[2]}})}).call(this)}},{key:"loadAtStationLocation",value:function(e){return tA(function(){var t,n,r,a,i,u;return tI(this,function(l){switch(l.label){case 0:if(t=this.starSystemView.scene.getActiveControls().getTransform(),void 0!==(r=(n=this.starSystemView.getStarSystem()).getOrbitalObjectById(e.universeObjectId.idInSystem))&&(r.type===O.o.SPACE_STATION||r.type===O.o.SPACE_ELEVATOR))return[3,2];return a=n.getStellarObjects()[0],(0,eB.gr)(a,new s.P(0,0,4*a.getBoundingRadius()),new o._f(0,0,0,1),t),[4,(0,eR.UX)("The space station you are trying to spawn at could not be found. You will spawn around the first stellar object of the system instead.",this.soundPlayer)];case 1:case 3:return l.sent(),[2];case 2:if(void 0!==(i=r.getLandingPadManager().getAvailableLandingPads().at(0)))return[3,4];return u=r,(0,eB.gr)(u,new s.P(0,0,4*u.getBoundingRadius()),new o._f(0,0,0,1),t),[4,(0,eR.UX)("There are no available pads at the space station you are trying to spawn at. You have been moved outside of the station instead.",this.soundPlayer)];case 4:return this.starSystemView.getSpaceshipControls().getSpaceship().spawnOnPad(i),[2]}})}).call(this)}}],t=[{key:"CreateAsync",value:function(){return tA(function(){var e,t,o,u,l,v,m,y,b,g,w,E,P,C,T;return tI(this,function(O){switch(O.label){case 0:if((e=document.getElementById("renderer")).width=window.innerWidth,e.height=window.innerHeight,t=new eM.a(e),!window.location.search.includes("webgpu"))return[3,2];return[4,i.u.CreateAsync(e,{twgslOptions:{wasmPath:new URL(n(43808),n.b).href,jsPath:new URL(n(78996),n.b).href},audioEngine:!0})];case 1:return u=O.sent(),[3,3];case 2:u=new a.D(e,!0,{preserveDrawingBuffer:!0,useHighPrecisionMatrix:!0,doNotHandleContextLost:!0,audioEngine:!0}),O.label=3;case 3:return(o=u).useReverseDepthBuffer=!0,o.loadingScreen=t,o.loadingScreen.displayLoadingUI(),window.addEventListener("resize",function(){e.width=window.innerWidth,e.height=window.innerHeight,o.resize(!0)}),[4,(0,ej.L)()];case 4:return O.sent(),console.log("API: ".concat(o.isWebGPU?"WebGPU":"WebGL")),console.log("GPU detected: ".concat(o.extractDriverInfo())),[4,(0,d.Z)()];case 5:var M,ew,eE;return l=O.sent(),console.log("Havok initialized"),v=new k.Z((0,L.D)()),v.registerGeneralPlugin(function(e){return(0,tP.q)([e.coordinates.starSectorX,e.coordinates.starSectorY,e.coordinates.starSectorZ,e.coordinates.localX,e.coordinates.localY,e.coordinates.localZ])>.5},function(e){var t=e.stellarObjects.map(function(e){return e.id});return e.anomalies.push((0,I.C)(t)),e}),m=eO.J.Default(v),(y=new f.t).backends.push(new h.O(v)),(b=new eV.E(o)).useRightHandedSystem=!0,(g=new c.a(!0,l)).setVelocityLimits(1e4,1e4),b.enablePhysics(s.P.Zero(),g),[4,(M=function(e,n){t.setProgressPercentage(e/n*100)},ew=b,(eE=function(){var e,t,n;return function(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){var l=[s,u];if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,r=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){i=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){i.label=l[1];break}if(6===l[0]&&i.label<a[1]){i.label=a[1],a=l;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(l);break}a[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}(this,function(r){switch(r.label){case 0:var a;return e=(a=function(){var e,t,n,r;return function(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){var l=[s,u];if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,r=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){i=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){i.label=l[1];break}if(6===l[0]&&i.label<a[1]){i.label=a[1],a=l;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(l);break}a[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}(this,function(a){switch(a.label){case 0:var i,o,s;return e=(i=function(){var e,t,n,r,a,i,o,s,u,l,c,d,h,f,v,p,m,y,b;return function(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){var l=[s,u];if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,r=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){i=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){i.label=l[1];break}if(6===l[0]&&i.label<a[1]){i.label=a[1],a=l;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(l);break}a[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}(this,function(g){switch(g.label){case 0:return e=0,t=0,r=(n=function(n,r,a){var i=new Promise(function(e){var t=new V.$(n,r,null,function(){e(t)},a)});return t++,i.then(function(n){return M(++e,t,n.name),n})})("OuchSound",ea),a=n("EngineRunningSound",er,{loop:!0}),i=n("MenuHoverSound",K,{playbackRate:.5}),o=n("MenuSelectSound",K),s=n("OpenPauseMenuSound",K,{playbackRate:.75}),u=n("TargetLockSound",en),l=n("TargetUnlockSound",en,{playbackRate:.5}),c=n("EnableWarpDriveSound",q,{playbackRate:2}),d=n("DisableWarpDriveSound",H),h=n("AcceleratingWarpDriveSound",Q,{playbackRate:1,volume:.3,loop:!0}),f=n("DeceleratingWarpDriveSound",ee,{playbackRate:1,volume:.3,loop:!0}),v=n("HyperSpaceSound",$,{playbackRate:1.5,volume:.25,loop:!0}),p=n("ThrusterSound",X,{playbackRate:1,volume:.5,loop:!0}),m=n("Success",et),y=n("Error",J),b={},[4,r];case 1:return b.ouch=g.sent(),[4,a];case 2:return b.engineRunning=g.sent(),[4,i];case 3:return b.menuHover=g.sent(),[4,o];case 4:return b.menuSelect=g.sent(),[4,s];case 5:return b.openPauseMenu=g.sent(),[4,u];case 6:return b.targetLock=g.sent(),[4,l];case 7:return b.targetUnlock=g.sent(),[4,c];case 8:return b.enableWarpDrive=g.sent(),[4,d];case 9:return b.disableWarpDrive=g.sent(),[4,h];case 10:return b.acceleratingWarpDrive=g.sent(),[4,f];case 11:return b.deceleratingWarpDrive=g.sent(),[4,v];case 12:return b.hyperSpace=g.sent(),[4,p];case 13:return b.thruster=g.sent(),[4,m];case 14:return b.success=g.sent(),[4,y];case 15:return[2,(b.error=g.sent(),b)]}})},function(){var e=this,t=arguments;return new Promise(function(n,r){var a=i.apply(e,t);function o(e){ei(a,n,r,o,s,"next",e)}function s(e){ei(a,n,r,o,s,"throw",e)}o(void 0)})})(),t=(o=function(){var e,t,n,r,a,i,o,s,u,l,c,d,h,f,v,p,m;return function(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){var l=[s,u];if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,r=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){i=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){i.label=l[1];break}if(6===l[0]&&i.label<a[1]){i.label=a[1],a=l;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(l);break}a[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}(this,function(y){switch(y.label){case 0:return e=0,t=0,r=(n=function(n,r,a){var i=new Promise(function(e){var t=new V.$(n,r,null,function(){e(t)},a)});return t++,i.then(function(n){return M(++e,t,n.name),n})})("Wandering",R,{loop:!0}),a=n("StraussBlueDanube",Z),i=n("DeepRelaxation",x),o=n("AtlanteanTwilight",D),s=n("InfinitePerspective",j),u=n("ThatZenMoment",z),l=n("EchoesOfTime",N),c=n("PeaceOfMind",F),d=n("SpacialWinds",B),h=n("Mesmerize",U),f=n("Reawakening",G),v=n("EquatorialComplex",_),p=n("Soaring",W),m={},[4,r];case 1:return m.wandering=y.sent(),[4,a];case 2:return m.straussBlueDanube=y.sent(),[4,i];case 3:return m.deepRelaxation=y.sent(),[4,o];case 4:return m.atlanteanTwilight=y.sent(),[4,s];case 5:return m.infinitePerspective=y.sent(),[4,u];case 6:return m.thatZenMoment=y.sent(),[4,l];case 7:return m.echoesOfTime=y.sent(),[4,c];case 8:return m.peaceOfMind=y.sent(),[4,d];case 9:return m.spacialWinds=y.sent(),[4,h];case 10:return m.mesmerize=y.sent(),[4,f];case 11:return m.reawakening=y.sent(),[4,v];case 12:return m.equatorialComplex=y.sent(),[4,p];case 13:return[2,(m.soaring=y.sent(),m)]}})},function(){var e=this,t=arguments;return new Promise(function(n,r){var a=o.apply(e,t);function i(e){Y(a,n,r,i,s,"next",e)}function s(e){Y(a,n,r,i,s,"throw",e)}i(void 0)})})(),n=(s=function(){var e,t,n,r,a,i,o,s,u,l,c,d,h,f,v,p;return function(e,t){var n,r,a,i={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},o=Object.create(("function"==typeof Iterator?Iterator:Object).prototype);return o.next=s(0),o.throw=s(1),o.return=s(2),"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(s){return function(u){var l=[s,u];if(n)throw TypeError("Generator is already executing.");for(;o&&(o=0,l[0]&&(i=0)),i;)try{if(n=1,r&&(a=2&l[0]?r.return:l[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,l[1])).done)return a;switch(r=0,a&&(l=[2&l[0],a.value]),l[0]){case 0:case 1:a=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,r=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!(a=(a=i.trys).length>0&&a[a.length-1])&&(6===l[0]||2===l[0])){i=0;continue}if(3===l[0]&&(!a||l[1]>a[0]&&l[1]<a[3])){i.label=l[1];break}if(6===l[0]&&i.label<a[1]){i.label=a[1],a=l;break}if(a&&i.label<a[2]){i.label=a[2],i.ops.push(l);break}a[2]&&i.ops.pop(),i.trys.pop();continue}l=t.call(e,i)}catch(e){l=[6,e],r=0}finally{n=a=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}}}(this,function(m){switch(m.label){case 0:return e=0,t=0,r=(n=function(n,r,a){var i=new Promise(function(e){var t=new V.$(n,r,null,function(){e(t)},a)});return t++,i.then(function(n){return M(++e,t,n.name),n})})("InitiatingPlanetaryLanding",ec),a=n("LandingRequestGranted",eh),i=n("LandingComplete",ed),o=n("MissionComplete",ef),s=n("NewDiscovery",ev),u=n("CannotEngageWarpDrive",eo),l=n("WarpDriveEmergencyShutDown",em),c=n("WarpDriveDisengaged",ep),d=n("EngagingWarpDrive",es),h=n("FuelScoopingVoice",eu),f=n("FuelScoopingCompleteVoice",el),v={},p={},[4,r];case 1:return p.initiatingPlanetaryLanding=m.sent(),[4,a];case 2:return p.landingRequestGranted=m.sent(),[4,i];case 3:return p.landingComplete=m.sent(),[4,o];case 4:return p.missionComplete=m.sent(),[4,s];case 5:return p.newDiscovery=m.sent(),[4,u];case 6:return p.cannotEngageWarpDrive=m.sent(),[4,l];case 7:return p.warpDriveEmergencyShutDown=m.sent(),[4,c];case 8:return p.warpDriveDisengaged=m.sent(),[4,d];case 9:return p.engagingWarpDrive=m.sent(),[4,h];case 10:return p.fuelScooping=m.sent(),[4,f];case 11:return[2,(v.charlotte=(p.fuelScoopingComplete=m.sent(),p),v)]}})},function(){var e=this,t=arguments;return new Promise(function(n,r){var a=s.apply(e,t);function i(e){ey(a,n,r,i,o,"next",e)}function o(e){ey(a,n,r,i,o,"throw",e)}i(void 0)})})(),r={},[4,e];case 1:return r.sounds=a.sent(),[4,t];case 2:return r.musics=a.sent(),[4,n];case 3:return[2,(r.speakerVoiceLines=a.sent(),r)]}})},function(){var e=this,t=arguments;return new Promise(function(n,r){var i=a.apply(e,t);function o(e){eb(i,n,r,o,s,"next",e)}function s(e){eb(i,n,r,o,s,"throw",e)}o(void 0)})})(),t=(0,eg.v)(M,ew),n={},[4,e];case 1:return n.audio=r.sent(),[4,t];case 2:return[2,(n.rendering=r.sent(),n)]}})},function(){var e=this,t=arguments;return new Promise(function(n,r){var a=eE.apply(e,t);function i(e){eS(a,n,r,i,o,"next",e)}function o(e){eS(a,n,r,i,o,"throw",e)}i(void 0)})})())];case 6:return w=O.sent(),E=new eT.st(w.audio.sounds),P=new eA.Ae(w.audio.speakerVoiceLines),[4,(C=new ek.p(b,m,o,g,y,v,E,P,w.rendering)).resetPlayer()];case 7:return O.sent(),[4,(0,tt.x)()];case 8:if(null!==O.sent())return[3,10];return[4,(0,eR.UX)("Your keyboard layout could not be detected. The QWERTY layout will be assumed by default.",E)];case 9:O.sent(),O.label=10;case 10:return[4,A.CreateAsync(new S,v)];case 11:if((T=O.sent()).success)return[3,13];return[4,(0,eR.UX)((0,p.M)(T.error),E)];case 12:throw O.sent(),Error("Failed to create save manager");case 13:return[2,new r(m,o,w,C,y,v,T.value,E,P)]}})})()}}],e&&tL(r.prototype,e),t&&tL(r,t),r}()},78996:function(e,t,n){e.exports=n.p+"869739fc3ede15e2.js"},80247:function(e,t,n){n.d(t,{Vj:()=>l,Yn:()=>s,oC:()=>d,z0:()=>u});var r=n(26980),a=n(69427),i=n(29375),o=i.Dx;function s(e,t){return(0,i.bw)(e,t)}function u(e){var t=window.location.href.split("?")[0],n=(0,a.o)(JSON.stringify(e));return null===n?null:new URL("".concat(t,"?save=").concat(n))}function l(e,t){var n=[],r=[],a=!0,i=!1,o=void 0;try{for(var u,l=e[Symbol.iterator]();!(a=(u=l.next()).done);a=!0){var c=u.value,d=s(c,t);d.success?n.push(d.value):r.push({save:c,error:d.error})}}catch(e){i=!0,o=e}finally{try{a||null==l.return||l.return()}finally{if(i)throw o}}return{validSaves:n,invalidSaves:r}}var c=r.z.object({manual:r.z.array(r.z.record(r.z.string(),r.z.unknown())),auto:r.z.array(r.z.record(r.z.string(),r.z.unknown()))});c.extend({manual:r.z.array(o),auto:r.z.array(o)});var d=r.z.record(r.z.string().uuid(),c)},91010:function(e,t,n){n.d(t,{P8:()=>a,Wl:()=>i});var r=n(61834);function a(e,t){for(var n=Math.floor(e.length/16),r=Math.floor(n/t),a=new Float32Array(16*r),i=0;i<r;i++){var o=16*Math.floor(Math.random()*n);a.set(e.subarray(o,o+16),16*i)}return a}function i(e,t,n,a){if(void 0===e[0]||void 0===e[1]||void 0===e[2]||void 0===e[3]||void 0===e[4]||void 0===e[5]||void 0===e[6]||void 0===e[7]||void 0===e[8]||void 0===e[9]||void 0===e[10]||void 0===e[11]||void 0===e[12]||void 0===e[13]||void 0===e[14]||void 0===e[15])throw Error("Matrix is not defined");t.set(e[12],e[13],e[14]);var i=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);a.set(i,i,i);var o=r.y3.Identity();o.setRowFromFloats(0,e[0]/i,e[1]/i,e[2]/i,0),o.setRowFromFloats(1,e[4]/i,e[5]/i,e[6]/i,0),o.setRowFromFloats(2,e[8]/i,e[9]/i,e[10]/i,0),o.setRowFromFloats(3,0,0,0,1),n.copyFrom(r._f.FromRotationMatrix(o))}},91307:function(e,t,n){function r(e){var t=[];return e.children.forEach(function(n,r){"x"!==r&&"y"!==r&&t.push([r,e.name])}),t}function a(e,t){var n=[];if(e.children.forEach(function(e,r){if("x"!==r&&"y"!==r){var a,i,o=e.name;o=o.replace("key:",""),o=null!=(i=null==t||null==(a=t.get(o))?void 0:a.toUpperCase())?i:o,n.push([r,o])}}),void 0===n[0]||void 0===n[1]||void 0===n[2]||void 0===n[3])throw Error("DPadComposite keys are undefined");return[n[2],n[0],n[3],n[1]]}function i(){return[["x","pointerX"],["y","pointerY"]]}function o(e,t){var n,r,a=e.name;return a=a.replace("key:",""),a=null!=(r=null==t||null==(n=t.get(a))?void 0:n.toUpperCase())?r:a}function s(e,t){var n=[];return e.children.forEach(function(e,r){var a,i,o=e.name;o=o.replace("key:",""),o=null!=(i=null==t||null==(a=t.get(o))?void 0:a.toUpperCase())?i:o,n.push([r,o])}),n}function u(e,t){return e.action.bindings.map(function(e){return o(e.control,t)})}n.d(t,{C9:()=>s,JT:()=>r,cs:()=>a,gG:()=>i,gW:()=>u,x_:()=>o})},91822:function(e,t,n){function r(e,t,n){return(0x466f45d*e^0x127409f*t^0x4f9ffb7*n)%1e9}function a(e){var t=0x811c9dc5,n=!0,r=!1,a=void 0;try{for(var i,o=e[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var s=i.value;t^=s,t=Math.imul(t,0x1000193)}}catch(e){r=!0,a=e}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}return(t>>>=0)/0xffffffff}n.d(t,{Z:()=>r,q:()=>a})},9852:function(e,t,n){n.d(t,{o:()=>a});var r=n(26980).z.object({});function a(e){try{return r.parse(JSON.parse(e))}catch(e){return null}}}}]);